<!DOCTYPE html>
<html data-bs-theme="light" lang="es-419">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Urban Noise</title>
    <meta name="theme-color" content="#000000">
    <link rel="canonical" href="https://urbannoise.cc/chat.html">
    <meta property="og:url" content="https://urbannoise.cc/chat.html">
    <meta name="twitter:image" content="https://urbannoise.cc/assets/img/logo/LOGO_WEB.png">
    <meta name="twitter:title" content="UrbanNoise">
    <meta name="twitter:card" content="summary">
    <meta property="og:type" content="article">
    <meta property="og:title" content="UrbanNoise">
    <meta property="og:image" content="https://urbannoise.cc/assets/img/logo/LOGO_WEB.png">
    <link rel="icon" type="image/png" sizes="709x709" href="assets/img/logo/LOGO_WEB.png">
    <link rel="icon" type="image/png" sizes="709x709" href="assets/img/logo/LOGO_WEB.png" media="(prefers-color-scheme: dark)">
    <link rel="icon" type="image/png" sizes="709x709" href="assets/img/logo/LOGO_WEB.png">
    <link rel="icon" type="image/png" sizes="709x709" href="assets/img/logo/LOGO_WEB.png" media="(prefers-color-scheme: dark)">
    <link rel="icon" type="image/png" sizes="709x709" href="assets/img/logo/LOGO_WEB.png">
    <link rel="icon" type="image/png" sizes="709x709" href="assets/img/logo/LOGO_WEB.png">
    <link rel="icon" type="image/png" sizes="709x709" href="assets/img/logo/LOGO_WEB.png">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="manifest" href="manifest.json" crossorigin="use-credentials">
    <link rel="stylesheet" href="assets/css/bootstrap-icons.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Plus+Jakarta+Sans&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap">
    <link rel="stylesheet" href="assets/css/swiper-icons.css">
    <link rel="stylesheet" href="assets/css/bs-theme-overrides.css">
    <link rel="stylesheet" href="assets/css/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/vendor/bootstrap-icons/bootstrap-icons.css">
    <link rel="stylesheet" href="assets/css/vendor/swiper/swiper-bundle.min.css">
    <link rel="stylesheet" href="assets/css/css/main.css">
    <link rel="stylesheet" href="assets/css/Articles-Cards-images.css">
    <link rel="stylesheet" href="assets/css/Lightbox-Gallery-No-Gutters-baguetteBox.min.css">
    <link rel="stylesheet" href="assets/css/Navbar-Centered-Brand-Dark-icons.css">
    <link rel="stylesheet" href="assets/css/tallas.css">
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyAj9GLeYHfwhgI_oje28uowybe6hs2d4xw",
    authDomain: "urbannoise-aed65.firebaseapp.com",
    projectId: "urbannoise-aed65",
    storageBucket: "urbannoise-aed65.firebasestorage.app",
    messagingSenderId: "407971144874",
    appId: "1:407971144874:web:65d027fa5bb68b81fa9cd3",
    measurementId: "G-2C4W1QJLF1"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
</script>

<!-- Manifiesto PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">
</head>

<body><!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URBAN - Asistente Virtual</title>
    <!-- Incluyendo Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Incluyendo la fuente Inter de Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Estilos personalizados para la aplicación */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Previene el scroll en el cuerpo de la página */
            font-family: 'Inter', sans-serif;
            background-color: #ffffff; 
        }
        .chat-container {
            width: 100%;
            height: 100%; /* Ocupa toda la altura en móviles */
            max-width: 100%;
            border: none;
            border-radius: 0;
        }
        .chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            min-height: 0;
        }
        .card-body p {
            white-space: pre-wrap;
            word-break: break-word;
        }
        .message-buttons .btn {
            margin-top: 8px;
            margin-right: 8px;
        }
        .typing-indicator span {
            height: 10px;
            width: 10px;
            background-color: #6c757d;
            display: inline-block;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1.0); }
        }

        /* Estilos para pantallas más grandes (Tablets y Escritorio) */
        @media (min-width: 768px) {
            body {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .chat-container {
                height: 85vh;
                max-height: 800px;
                max-width: 700px;
                border: 1px solid #dee2e6;
                border-radius: .5rem; /* Bootstrap .rounded-2 */
                box-shadow: 0 .5rem 1rem rgba(0,0,0,.15); /* Bootstrap .shadow-lg */
            }
        }
    </style>
</head>
<body>

    <div class="chat-container d-flex flex-column">
        <!-- Cabecera del Chat -->
        <div class="card-header text-white d-flex justify-content-between align-items-center p-3" style="background-color: #000000;">
            <h1 class="h5 mb-0 fw-bold">URBAN | Comunidad Noise</h1>
            <img src="https://urbannoise.cc/assets/img/logo/lSOTIPO%20BLANCO%20WEB.png" alt="Logo Urban Noise" style="width: 40px; height: 40px; object-fit: contain;">
        </div>

        <!-- Área de Mensajes -->
        <div id="chat-messages" class="card-body p-4 chat-messages">
            <!-- Los mensajes se agregarán aquí dinámicamente -->
        </div>

        <!-- Indicador de "Escribiendo..." -->
        <div id="typing-indicator" class="p-4 d-none">
             <div class="d-flex align-items-start gap-3">
                <img src="https://urbannoise.cc/assets/img/logo/lSOTIPO%20BLANCO%20WEB.png" alt="Typing Indicator" class="rounded-circle" style="width: 40px; height: 40px; object-fit: contain;">
                <div class="card bg-white border"><div class="card-body p-3"><div class="typing-indicator"><span></span><span></span><span></span></div></div></div>
            </div>
        </div>

        <!-- Formulario de Entrada -->
        <div class="card-footer p-3 bg-white border-top">
            <form id="chat-form" class="d-flex align-items-center gap-2">
                <input type="text" id="user-input" placeholder="Escribe tu mensaje aquí..." autocomplete="off" class="form-control form-control-lg rounded-pill">
                <button type="submit" id="send-button" class="btn btn-dark btn-lg rounded-circle d-flex align-items-center justify-content-center" style="background-color: #000000; border-color: #000000; width: 50px; height: 50px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-send"><path d="m22 2-7 20-4-9-9-4Z"/><path d="M22 2 11 13"/></svg>
                </button>
            </form>
        </div>
    </div>

    <!-- Incluyendo Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
        const chatForm = document.getElementById('chat-form');
        const userInput = document.getElementById('user-input');
        const chatMessages = document.getElementById('chat-messages');
        const sendButton = document.getElementById('send-button');
        const typingIndicator = document.getElementById('typing-indicator');

        const system_prompt = `
            Eres URBAN, el asistente de Urban Noise. Tu objetivo es conectar a los clientes con la marca de forma rápida y útil.
            REGLA PRINCIPAL: Tus respuestas deben ser cortas y directas. Utiliza el formato de botones [Texto](URL) SÓLO CUANDO SEA NECESARIO Y LÓGICO.
            
            DEBES RESPONDER EXCLUSIVamente CON BASE EN LA SIGUIENTE INFORMACIÓN. No inventes datos. Si se te consulta algo fuera de la información provista, tu ÚNICA respuesta debe ser: "Sobre eso no sé. Puedes [Hablar con un agente](whatsapp:+573108720491) o [visitar la web](https://www.UrbanNoise.co)."

            **1. Saludos y Conversación General:**
            - Si el usuario te saluda con "hola", "buenas", "cómo estás" o algo similar, responde de forma amigable y corta, y luego pregunta en qué puedes ayudar. EJEMPLO: "¡Qué más! ¿Todo bien? Dime qué necesitas ver hoy." o "¡Hey! ¿Listo para ver lo nuevo?". NO ofrezcas botones en un saludo simple.

            **2. Web y Colecciones:**
            - **Pregunta sobre Novedades:** Si te preguntan por "novedades", responde: "Lo último siempre está en la web. ¿Qué categoría te interesa ver? [Buzos](https://www.urbannoise.co/buzos) [Camisetas](https://www.urbannoise.co/oversize) [Pantalones](https://www.urbannoise.co/pantalones) [Ver todo](https://www.UrbanNoise.co)"
            - **Web principal:** Si preguntan por la página o el sitio, responde: "Aquí tienes el link a la web principal: [UrbanNoise.co](https://www.UrbanNoise.co)"
            - **Categorías específicas:**
              - Camisetas: "Claro, mira las camisetas aquí: [Ver Camisetas Oversize](https://www.urbannoise.co/oversize)"
              - Buzos: "Aquí están los buzos: [Ver Buzos](https://www.urbannoise.co/buzos)"
              - Conjuntos: "Los conjuntos están aquí: [Ver Conjuntos](https://www.urbannoise.co/conjuntos)"
              - Pantalones: "Mira los pantalones: [Ver Pantalones](https://www.urbannoise.co/pantalones)"

            **3. Redes Sociales:**
            - **Instagram:** "Síguenos para no perderte de nada: [Ver Instagram](https://www.instagram.com/urban_noise_/)"
            - **TikTok:** "Nuestros últimos videos y tendencias: [Ver TikTok](https://www.tiktok.com/@urban_noise)"

            **4. Soporte y Contacto:**
            - **Contacto directo:** Si preguntan por un agente o contacto, responde: "Claro, habla con un agente directamente: [Contactar por WhatsApp](whatsapp:+573108720491)"
            - **Ubicación:** "Estamos en el C.C. El Gran San, Local 2268, Bogotá."
        `;

        let chatHistory = [
            { "role": "user", "parts": [{ "text": system_prompt }] },
            { "role": "model", "parts": [{"text": "Entendido. Soy URBAN. Directo y al grano. Listo para la comunidad Noise."}] }
        ];

        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const userMessage = userInput.value.trim();
            if (!userMessage) return;

            userInput.disabled = true;
            sendButton.disabled = true;
            addMessage(userMessage, 'user');
            userInput.value = '';

            typingIndicator.classList.remove('d-none');
            chatMessages.appendChild(typingIndicator);
            scrollToBottom();

            try {
                chatHistory.push({ role: "user", parts: [{ text: userMessage }] });
                const payload = { contents: chatHistory };
                const apiKey = "AIzaSyAPPw3GgpKEnEVkvNuCnWOcoM433yXQLhQ";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) throw new Error(`Error en la API: ${response.status}`);

                const result = await response.json();
                let botMessage = "No pude procesar esa solicitud. Intenta de nuevo.";

                if (result.candidates && result.candidates[0].content && result.candidates[0].content.parts[0]) {
                    botMessage = result.candidates[0].content.parts[0].text;
                    chatHistory.push({ role: "model", parts: [{ text: botMessage }] });
                } else if (result.promptFeedback && result.promptFeedback.blockReason) {
                    botMessage = `Tu solicitud fue bloqueada. Intenta con otra pregunta.`;
                }
                
                typingIndicator.classList.add('d-none');
                addMessage(botMessage, 'bot');
            } catch (error) {
                console.error("Error al contactar la API de Gemini:", error);
                typingIndicator.classList.add('d-none');
                addMessage(`Error técnico. Intenta de nuevo más tarde.`, 'bot-error');
            } finally {
                userInput.disabled = false;
                sendButton.disabled = false;
                userInput.focus();
            }
        });

        function addMessage(text, sender) {
            const messageWrapper = document.createElement('div');
            messageWrapper.className = `d-flex align-items-start gap-3 mb-3 ${sender === 'user' ? 'justify-content-end' : 'justify-content-start'}`;
            
            const buttonRegex = /\[([^\]]+)\]\(([^)]+)\)/g;
            let messageText = text.replace(/<|>/g, '');
            let buttonsHTML = '';
            
            messageText = messageText.replace(buttonRegex, (match, buttonText, url) => {
                let finalUrl = url;
                let buttonClass = 'btn btn-sm btn-outline-dark';
                
                if (url.startsWith('whatsapp:')) {
                    const phone = url.split(':')[1].replace(/\D/g, '');
                    const message = encodeURIComponent("Hola Urban Noise, te contacto desde el asistente URBAN.");
                    finalUrl = `https://wa.me/${phone}?text=${message}`;
                    buttonClass = 'btn btn-sm text-white';
                } else if (!url.startsWith('http')) {
                    finalUrl = 'https://' + url;
                }
                
                let style = url.startsWith('whatsapp:') ? 'background-color: #000000; border-color: #000000;' : '';

                buttonsHTML += `<a href="${finalUrl}" target="_blank" class="${buttonClass}" style="${style}">${buttonText}</a> `;
                return '';
            }).trim();
            
            const sanitizedText = messageText;
            let html = '';

            const botIcon = `<img src="https://urbannoise.cc/assets/img/logo/lSOTIPO%20BLANCO%20WEB.png" alt="Logo Urban Noise" style="width: 40px; height: 40px; object-fit: contain;">`;
            const userIcon = `<div class="bg-white border rounded-circle d-flex align-items-center justify-content-center flex-shrink-0" style="width: 40px; height: 40px;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-dark"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></div>`;

            const messageContentHTML = `<p class="mb-0">${sanitizedText}</p><div class="message-buttons">${buttonsHTML}</div>`;

            if (sender === 'user') {
                const card = `<div class="card text-white border-0" style="background-color: #000000; max-width: 80%;"><div class="card-body p-3 rounded-3"><p class="fw-bold mb-1">Tú</p><p class="mb-0">${text}</p></div></div>`;
                html = card + userIcon;
            } else {
                let cardClass = sender === 'bot-error' ? 'bg-danger-subtle text-danger-emphasis' : 'bg-white border';
                const card = `<div class="card ${cardClass}" style="max-width: 80%;"><div class="card-body p-3 rounded-3"><p class="fw-bold mb-1">URBAN</p>${messageContentHTML}</div></div>`;
                html = botIcon + card;
            }

            messageWrapper.innerHTML = html;
            chatMessages.appendChild(messageWrapper);
            scrollToBottom();
        }

        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        window.addEventListener('load', () => {
             addMessage("¡Esa prenda es puro flow! Ya eres de la casa. ¿Qué quieres ver? [Novedades en la Web](https://www.urbannoise.co) o [Lo último en Redes](https://www.instagram.com/urban_noise_/)", 'bot');
             userInput.focus();
        });

    </script>
</body>
</html>

    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/bs-init.js"></script>
    <script src="assets/js/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/vendor/php-email-form/validate.js"></script>
    <script src="assets/js/vendor/aos/aos.js"></script>
    <script src="assets/js/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="assets/js/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="assets/js/js/main.js"></script>
    <script src="assets/js/blogger.js"></script>
    <script src="assets/js/compartir.js"></script>
    <script src="assets/js/Lightbox-Gallery-No-Gutters-baguetteBox.min.js"></script>
    <script src="assets/js/Lightbox-Gallery-No-Gutters-Lightbox-Gallery.js"></script>
    <script src="assets/js/pagina.js"></script>
    <script src="assets/js/search.js"></script>
    <script src="assets/js/WhatsApp%20Camisetas.js"></script>
</body>

</html>